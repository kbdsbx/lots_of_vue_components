<template>
<amap
:meta="map_meta"
:polygons="polygons"
:pins="pins"
:labels="labels"
v-on:click-polygon="map_click"
v-on:click-pin="pin_click" 
v-on:click-label="label_click"
v-on:map-move="area_change"
></amap>
</template>

<script>
import Amap from '../components/Map/AMap.vue'
let url = require( '../assets/map_pin.png' );
let url2 = require( '../assets/map_pin_2.png' );

export default {
  name: 'app',
  components: {
    Amap,
  },
  methods : {
    map_click ( e ) {
      var idx = this.polygons.findIndex( x=> x.id == '0' );
      // this.$set( this.polygons[idx], 'fillColor', '#8ae3fa' );
      var color = [ 'red', 'white', '#8ae3fa', '#98273a', '#6bf23s' ][Math.floor( Math.random() * 5 )];
      this.$set( this.polygons, idx, { ...this.polygons[idx], fillColor: color } )
        if ( Math.random() < .1 ) {
            this.polygons= [];
        }
    },
    pin_click ( e ) {
      var idx = this.pins.findIndex( x=> x.id == '1' );
      var obj = this.pins[idx];
      obj.image = ( obj.image == url2 ) ? url : url2;
      this.$set( this.pins, idx, obj );
        if ( Math.random() < .1 ) {
            this.pins= [];
        }
    },
    label_click ( e ) {
        var idx = this.labels.findIndex( x=> x.id == '1' );
        var obj = this.labels[idx];
        obj.style['background-color'] = [ 'red', 'white', '#8ae3fa', '#98273a', '#6bf23s' ][Math.floor( Math.random() * 5 )];
        this.$set( this.labels, idx, obj );
        if ( Math.random() < .1 ) {
            this.labels = [];
        }
    },
    area_change( e ) {
    }
  },
  data () {
    return {
      map_meta : {
        center: [120.187564, 30.250364],
        resizeEnable: true,
        zoom: 16,
        mapStyle: 'amap://styles/grey'
      },
      labels : [
        {
            id: '1',
            text : '余杭',
            lng: 119.921213,
            lat: 30.407693,
            style : {
                'color': '#fff',
                'background-color' : '#469a21',
                'padding' : '2px 6px',
                'font-size' : '12px',
            }
        }
      ],
      pins : [
        {
          id: '1',
          image : url,
          lng : 120.187564,
          lat : 30.250364,
        }
      ],
      polygons : [
        {
          id: '0',
          path: [
            [
                "120.330254",
                "30.431425"
            ],
            [
                "120.331688",
                "30.420700"
            ],
            [
                "120.322865",
                "30.415325"
            ],
            [
                "120.321237",
                "30.408515"
            ],
            [
                "120.305911",
                "30.401015"
            ],
            [
                "120.305696",
                "30.397103"
            ],
            [
                "120.314401",
                "30.398990"
            ],
            [
                "120.318707",
                "30.381053"
            ],
            [
                "120.341096",
                "30.374665"
            ],
            [
                "120.343858",
                "30.369766"
            ],
            [
                "120.333987",
                "30.362319"
            ],
            [
                "120.330912",
                "30.363535"
            ],
            [
                "120.324900",
                "30.354790"
            ],
            [
                "120.299873",
                "30.350145"
            ],
            [
                "120.292617",
                "30.326418"
            ],
            [
                "120.295158",
                "30.317430"
            ],
            [
                "120.294691",
                "30.324946"
            ],
            [
                "120.299402",
                "30.325559"
            ],
            [
                "120.298673",
                "30.312046"
            ],
            [
                "120.290983",
                "30.316005"
            ],
            [
                "120.291138",
                "30.318798"
            ],
            [
                "120.271619",
                "30.321740"
            ],
            [
                "120.282222",
                "30.329818"
            ],
            [
                "120.277961",
                "30.340637"
            ],
            [
                "120.266472",
                "30.333219"
            ],
            [
                "120.267795",
                "30.329360"
            ],
            [
                "120.264274",
                "30.327684"
            ],
            [
                "120.256681",
                "30.336018"
            ],
            [
                "120.260950",
                "30.339622"
            ],
            [
                "120.249953",
                "30.338614"
            ],
            [
                "120.243000",
                "30.340197"
            ],
            [
                "120.239735",
                "30.344518"
            ],
            [
                "120.231333",
                "30.343515"
            ],
            [
                "120.243207",
                "30.352540"
            ],
            [
                "120.241744",
                "30.359654"
            ],
            [
                "120.245963",
                "30.361833"
            ],
            [
                "120.244671",
                "30.369707"
            ],
            [
                "120.239787",
                "30.369867"
            ],
            [
                "120.240355",
                "30.372864"
            ],
            [
                "120.231555",
                "30.378109"
            ],
            [
                "120.239586",
                "30.389727"
            ],
            [
                "120.238156",
                "30.392372"
            ],
            [
                "120.226494",
                "30.395491"
            ],
            [
                "120.216024",
                "30.388601"
            ],
            [
                "120.214589",
                "30.392058"
            ],
            [
                "120.202833",
                "30.393354"
            ],
            [
                "120.194932",
                "30.397793"
            ],
            [
                "120.195129",
                "30.403024"
            ],
            [
                "120.187444",
                "30.402029"
            ],
            [
                "120.190129",
                "30.396078"
            ],
            [
                "120.172555",
                "30.374080"
            ],
            [
                "120.169120",
                "30.378305"
            ],
            [
                "120.168271",
                "30.373837"
            ],
            [
                "120.158227",
                "30.374321"
            ],
            [
                "120.152092",
                "30.378146"
            ],
            [
                "120.151354",
                "30.382820"
            ],
            [
                "120.145107",
                "30.377704"
            ],
            [
                "120.138763",
                "30.377818"
            ],
            [
                "120.137085",
                "30.382343"
            ],
            [
                "120.127723",
                "30.385104"
            ],
            [
                "120.137116",
                "30.340772"
            ],
            [
                "120.127429",
                "30.344111"
            ],
            [
                "120.113653",
                "30.338747"
            ],
            [
                "120.105025",
                "30.344041"
            ],
            [
                "120.083446",
                "30.332771"
            ],
            [
                "120.071226",
                "30.352525"
            ],
            [
                "120.059660",
                "30.354141"
            ],
            [
                "120.045655",
                "30.349755"
            ],
            [
                "120.040612",
                "30.353453"
            ],
            [
                "120.030583",
                "30.353078"
            ],
            [
                "120.022875",
                "30.349558"
            ],
            [
                "120.024980",
                "30.335948"
            ],
            [
                "120.016617",
                "30.333187"
            ],
            [
                "120.022653",
                "30.323194"
            ],
            [
                "120.022400",
                "30.317199"
            ],
            [
                "120.018154",
                "30.316630"
            ],
            [
                "120.022253",
                "30.313287"
            ],
            [
                "120.019740",
                "30.309523"
            ],
            [
                "120.024937",
                "30.309229"
            ],
            [
                "120.029313",
                "30.299893"
            ],
            [
                "120.042265",
                "30.304184"
            ],
            [
                "120.054634",
                "30.298717"
            ],
            [
                "120.051140",
                "30.292569"
            ],
            [
                "120.055122",
                "30.288356"
            ],
            [
                "120.048546",
                "30.275954"
            ],
            [
                "120.055117",
                "30.248179"
            ],
            [
                "120.050878",
                "30.247107"
            ],
            [
                "120.048850",
                "30.241974"
            ],
            [
                "120.044710",
                "30.243440"
            ],
            [
                "120.045455",
                "30.238363"
            ],
            [
                "120.040155",
                "30.237033"
            ],
            [
                "120.039712",
                "30.232867"
            ],
            [
                "120.005437",
                "30.221569"
            ],
            [
                "120.007840",
                "30.215986"
            ],
            [
                "120.016362",
                "30.213111"
            ],
            [
                "120.007904",
                "30.207047"
            ],
            [
                "120.004179",
                "30.207802"
            ],
            [
                "120.008477",
                "30.194555"
            ],
            [
                "119.999649",
                "30.188360"
            ],
            [
                "119.994151",
                "30.177859"
            ],
            [
                "119.985223",
                "30.172834"
            ],
            [
                "119.968471",
                "30.174588"
            ],
            [
                "119.962435",
                "30.172227"
            ],
            [
                "119.960804",
                "30.167934"
            ],
            [
                "119.951845",
                "30.168229"
            ],
            [
                "119.939404",
                "30.158512"
            ],
            [
                "119.934012",
                "30.158356"
            ],
            [
                "119.932190",
                "30.172608"
            ],
            [
                "119.936591",
                "30.178586"
            ],
            [
                "119.930186",
                "30.179350"
            ],
            [
                "119.931629",
                "30.184664"
            ],
            [
                "119.918786",
                "30.191456"
            ],
            [
                "119.901121",
                "30.187225"
            ],
            [
                "119.892972",
                "30.193620"
            ],
            [
                "119.886128",
                "30.191537"
            ],
            [
                "119.882970",
                "30.186893"
            ],
            [
                "119.880110",
                "30.189861"
            ],
            [
                "119.865590",
                "30.179471"
            ],
            [
                "119.860974",
                "30.180605"
            ],
            [
                "119.850674",
                "30.175776"
            ],
            [
                "119.848967",
                "30.183136"
            ],
            [
                "119.844106",
                "30.185600"
            ],
            [
                "119.846207",
                "30.189223"
            ],
            [
                "119.839228",
                "30.190824"
            ],
            [
                "119.832847",
                "30.199372"
            ],
            [
                "119.840583",
                "30.207678"
            ],
            [
                "119.840495",
                "30.219988"
            ],
            [
                "119.857331",
                "30.227405"
            ],
            [
                "119.855819",
                "30.232313"
            ],
            [
                "119.861286",
                "30.235825"
            ],
            [
                "119.864998",
                "30.253644"
            ],
            [
                "119.860834",
                "30.257689"
            ],
            [
                "119.861428",
                "30.273678"
            ],
            [
                "119.846594",
                "30.275092"
            ],
            [
                "119.845515",
                "30.269118"
            ],
            [
                "119.838876",
                "30.272558"
            ],
            [
                "119.825362",
                "30.271623"
            ],
            [
                "119.822820",
                "30.288386"
            ],
            [
                "119.833080",
                "30.290454"
            ],
            [
                "119.836055",
                "30.295555"
            ],
            [
                "119.830168",
                "30.301189"
            ],
            [
                "119.831355",
                "30.308594"
            ],
            [
                "119.822322",
                "30.308363"
            ],
            [
                "119.805808",
                "30.297065"
            ],
            [
                "119.797168",
                "30.299280"
            ],
            [
                "119.797882",
                "30.314962"
            ],
            [
                "119.800654",
                "30.315620"
            ],
            [
                "119.798062",
                "30.322727"
            ],
            [
                "119.803984",
                "30.328947"
            ],
            [
                "119.804238",
                "30.334872"
            ],
            [
                "119.800441",
                "30.337078"
            ],
            [
                "119.802461",
                "30.343562"
            ],
            [
                "119.784364",
                "30.345794"
            ],
            [
                "119.787878",
                "30.350386"
            ],
            [
                "119.788045",
                "30.360093"
            ],
            [
                "119.771013",
                "30.368959"
            ],
            [
                "119.769260",
                "30.374121"
            ],
            [
                "119.775029",
                "30.377946"
            ],
            [
                "119.769172",
                "30.378414"
            ],
            [
                "119.764937",
                "30.383221"
            ],
            [
                "119.761187",
                "30.378321"
            ],
            [
                "119.756611",
                "30.380879"
            ],
            [
                "119.752845",
                "30.378021"
            ],
            [
                "119.745261",
                "30.387068"
            ],
            [
                "119.751397",
                "30.389926"
            ],
            [
                "119.751901",
                "30.393912"
            ],
            [
                "119.746521",
                "30.393044"
            ],
            [
                "119.741692",
                "30.397492"
            ],
            [
                "119.730619",
                "30.397186"
            ],
            [
                "119.730306",
                "30.399537"
            ],
            [
                "119.721791",
                "30.397080"
            ],
            [
                "119.722942",
                "30.393555"
            ],
            [
                "119.713176",
                "30.391711"
            ],
            [
                "119.708391",
                "30.397378"
            ],
            [
                "119.675665",
                "30.412113"
            ],
            [
                "119.688757",
                "30.430877"
            ],
            [
                "119.700835",
                "30.433750"
            ],
            [
                "119.698161",
                "30.450914"
            ],
            [
                "119.693124",
                "30.450501"
            ],
            [
                "119.692562",
                "30.454485"
            ],
            [
                "119.686856",
                "30.456532"
            ],
            [
                "119.690726",
                "30.460184"
            ],
            [
                "119.689562",
                "30.468869"
            ],
            [
                "119.696236",
                "30.471358"
            ],
            [
                "119.702401",
                "30.485814"
            ],
            [
                "119.704201",
                "30.494793"
            ],
            [
                "119.698747",
                "30.499240"
            ],
            [
                "119.703851",
                "30.508003"
            ],
            [
                "119.702714",
                "30.524644"
            ],
            [
                "119.689508",
                "30.546747"
            ],
            [
                "119.685245",
                "30.562288"
            ],
            [
                "119.687765",
                "30.565283"
            ],
            [
                "119.701076",
                "30.563984"
            ],
            [
                "119.714252",
                "30.568956"
            ],
            [
                "119.717630",
                "30.558448"
            ],
            [
                "119.728212",
                "30.558379"
            ],
            [
                "119.734761",
                "30.553781"
            ],
            [
                "119.737104",
                "30.557212"
            ],
            [
                "119.750209",
                "30.558012"
            ],
            [
                "119.761753",
                "30.563257"
            ],
            [
                "119.765882",
                "30.553032"
            ],
            [
                "119.760892",
                "30.541945"
            ],
            [
                "119.765780",
                "30.532013"
            ],
            [
                "119.756110",
                "30.525234"
            ],
            [
                "119.756131",
                "30.522023"
            ],
            [
                "119.780083",
                "30.516446"
            ],
            [
                "119.784938",
                "30.510598"
            ],
            [
                "119.796926",
                "30.510355"
            ],
            [
                "119.815529",
                "30.516223"
            ],
            [
                "119.829970",
                "30.502244"
            ],
            [
                "119.840260",
                "30.502436"
            ],
            [
                "119.847483",
                "30.506650"
            ],
            [
                "119.853049",
                "30.495032"
            ],
            [
                "119.861620",
                "30.487858"
            ],
            [
                "119.859288",
                "30.483777"
            ],
            [
                "119.870009",
                "30.483095"
            ],
            [
                "119.876283",
                "30.479215"
            ],
            [
                "119.868460",
                "30.475582"
            ],
            [
                "119.870050",
                "30.465579"
            ],
            [
                "119.882128",
                "30.464753"
            ],
            [
                "119.888668",
                "30.459486"
            ],
            [
                "119.897753",
                "30.464949"
            ],
            [
                "119.907248",
                "30.460634"
            ],
            [
                "119.912116",
                "30.465594"
            ],
            [
                "119.920981",
                "30.467635"
            ],
            [
                "119.919167",
                "30.460995"
            ],
            [
                "119.925406",
                "30.463986"
            ],
            [
                "119.929395",
                "30.462381"
            ],
            [
                "119.927155",
                "30.456251"
            ],
            [
                "119.932362",
                "30.449903"
            ],
            [
                "119.937869",
                "30.449321"
            ],
            [
                "119.945358",
                "30.455967"
            ],
            [
                "119.949459",
                "30.450935"
            ],
            [
                "119.949712",
                "30.439477"
            ],
            [
                "119.960850",
                "30.434093"
            ],
            [
                "119.968711",
                "30.437171"
            ],
            [
                "119.970196",
                "30.442793"
            ],
            [
                "119.979720",
                "30.450694"
            ],
            [
                "119.998038",
                "30.450879"
            ],
            [
                "120.005904",
                "30.442356"
            ],
            [
                "120.036029",
                "30.439794"
            ],
            [
                "120.033471",
                "30.430155"
            ],
            [
                "120.061997",
                "30.434869"
            ],
            [
                "120.059498",
                "30.440706"
            ],
            [
                "120.065443",
                "30.450271"
            ],
            [
                "120.056365",
                "30.464057"
            ],
            [
                "120.056084",
                "30.479529"
            ],
            [
                "120.061696",
                "30.488439"
            ],
            [
                "120.064883",
                "30.504572"
            ],
            [
                "120.070659",
                "30.502094"
            ],
            [
                "120.073438",
                "30.505076"
            ],
            [
                "120.092856",
                "30.504043"
            ],
            [
                "120.095531",
                "30.501967"
            ],
            [
                "120.092054",
                "30.496263"
            ],
            [
                "120.093465",
                "30.491003"
            ],
            [
                "120.109581",
                "30.481212"
            ],
            [
                "120.143114",
                "30.490639"
            ],
            [
                "120.144060",
                "30.478117"
            ],
            [
                "120.147601",
                "30.473959"
            ],
            [
                "120.176375",
                "30.485443"
            ],
            [
                "120.170167",
                "30.491536"
            ],
            [
                "120.172640",
                "30.493011"
            ],
            [
                "120.178066",
                "30.488625"
            ],
            [
                "120.180364",
                "30.490619"
            ],
            [
                "120.173917",
                "30.494045"
            ],
            [
                "120.177687",
                "30.496032"
            ],
            [
                "120.172109",
                "30.500637"
            ],
            [
                "120.177545",
                "30.499109"
            ],
            [
                "120.183676",
                "30.501543"
            ],
            [
                "120.178898",
                "30.503643"
            ],
            [
                "120.179172",
                "30.507502"
            ],
            [
                "120.186671",
                "30.512489"
            ],
            [
                "120.191090",
                "30.509973"
            ],
            [
                "120.197027",
                "30.522790"
            ],
            [
                "120.200260",
                "30.512769"
            ],
            [
                "120.208323",
                "30.519147"
            ],
            [
                "120.227336",
                "30.518559"
            ],
            [
                "120.226430",
                "30.522892"
            ],
            [
                "120.238829",
                "30.513863"
            ],
            [
                "120.269797",
                "30.516453"
            ],
            [
                "120.274116",
                "30.514322"
            ],
            [
                "120.279115",
                "30.517899"
            ],
            [
                "120.284545",
                "30.516868"
            ],
            [
                "120.285070",
                "30.521476"
            ],
            [
                "120.298174",
                "30.529598"
            ],
            [
                "120.316363",
                "30.531057"
            ],
            [
                "120.325764",
                "30.500532"
            ],
            [
                "120.326512",
                "30.474195"
            ],
            [
                "120.336603",
                "30.480946"
            ],
            [
                "120.340498",
                "30.472080"
            ],
            [
                "120.335560",
                "30.470424"
            ],
            [
                "120.339699",
                "30.439139"
            ],
            [
                "120.335231",
                "30.438721"
            ],
            [
                "120.335501",
                "30.434458"
            ],
            [
                "120.330254",
                "30.431425"
            ]
          ],
        }
      ]
    }
  }
}
</script>
